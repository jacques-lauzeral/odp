# workspace/server/src/api/openapi-docx.yml
openapi: 3.0.3

info:
  title: ODP REST API / DocX Export
  description: Word document export operations for operational requirements
  version: 1.0.0

paths:
  /docx/export:
    get:
      summary: Export operational requirements and changes as Word document
      tags: [Export]
      parameters:
        - name: drg
          in: query
          required: true
          schema:
            $ref: 'openapi-base.yml#/components/schemas/DraftingGroup'
          description: "Drafting Group to export requirements for"
        - name: folder
          in: query
          required: false
          schema:
            type: string
          description: "Folder path filter (e.g., 'ADP' or 'ADP/SubFolder'). Exports items where path starts with specified folder hierarchy. Omit to export all."
          example: "ADP/Planning"
      responses:
        '200':
          description: Word document generated successfully
          content:
            application/vnd.openxmlformats-officedocument.wordprocessingml.document:
              schema:
                type: string
                format: binary
        '400':
          description: Bad Request - Invalid or missing DRG parameter
          content:
            application/json:
              schema:
                $ref: 'openapi-base.yml#/components/schemas/Error'
        '500':
          description: Internal Server Error
          content:
            application/json:
              schema:
                $ref: 'openapi-base.yml#/components/schemas/Error'